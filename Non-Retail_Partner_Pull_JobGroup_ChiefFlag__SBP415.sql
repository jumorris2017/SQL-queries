--select JOB_ABBREV_NM, CHIEF_FLAG, COUNT(*) from HPOHLMAN.ALL_POSN_CURRENT 
--group by JOB_ABBREV_NM, CHIEF_FLAG
--order by JOB_ABBREV_NM, CHIEF_FLAG

select c.SAP_PRTNR_ID, c.CHIEF_FLAG,
(case when c.JOB_ABBREV_NM IN ('svp', 'evp', 'svp & gm', 'president', 'coo', 'chairman', 'cfo', 'ceo') then 'SVP+'
    when c.JOB_ABBREV_NM = 'vp' then 'VP'
    when c.JOB_ABBREV_NM = 'dir' then 'DIR'
    when c.JOB_ABBREV_NM = 'mgr sr' then 'SR MGR'
    when c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25 then 'MGR'
    when c.PAY_GRADE_CD IN('23','24') then 'IC II'
    when CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) < 23 and  CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >0 then 'IC I'
    when c.JOB_ABBREV_NM = 'cw' or c.EMP_STAT_CD = 'NonPartner Workforce' then 'CW'
    when c.JOB_ABBREV_NM = 'internship' then 'INTERN'
end) as JOB_GROUP 

from HPOHLMAN.ALL_POSN_CURRENT c
where c.SNAPSHOT_DT = to_date('02-26-2018', 'MM-DD-YYYY')

 

--updates with people manager status
--non-retail_job_1.csv
--pre-bias_survey_1.csv
select c.SAP_PRTNR_ID, c.JOB_ABBREV_NM, c.CHIEF_FLAG,
(case when c.JOB_ABBREV_NM IN ('svp', 'evp', 'svp & gm', 'president', 'coo', 'chairman', 'cfo', 'ceo') then 'VP+'
    when c.JOB_ABBREV_NM = 'vp' then 'VP+'
    when c.JOB_ABBREV_NM = 'dir' then 'DIR'
    when c.JOB_ABBREV_NM = 'mgr sr' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'Y' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'N' then 'IC'
    when c.PAY_GRADE_CD IN('23','24') then 'IC'
    when CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) < 23 and  CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >0 then 'IC'
    when c.JOB_ABBREV_NM = 'cw' or c.EMP_STAT_CD = 'NonPartner Workforce' then 'CW'
    when c.JOB_ABBREV_NM = 'internship' then 'INTERN'
end) as JOB_GROUP 
 
from HPOHLMAN.ALL_POSN_CURRENT c
where c.SNAPSHOT_DT = (select max(SNAPSHOT_DT) from HPOHLMAN.ALL_POSN_CURRENT)
AND c.SAP_PRTNR_ID IN 
(412039	,
1786386	,
1834186	,
2094405	,
1495793	,
1274918	,
1937952	,
2064079	,
1104665	,
1130862	,
1800418	,
1722208	,
1207061	,
1362242	,
1329755	,
1718092	,
267556	,
1279161	,
1297107	,
327191	,
1237277	,
1417498	,
1095910	,
1329552	,
200386	,
1354430	,
1845988	,
1772448	,
1226484	,
1765576	,
1174305	,
353321	,
1679849	,
209091	,
1713763	,
1202572	,
1044668	,
1114810	,
1141454	,
1839080	,
1128524	,
15024	,
411628	,
1972373	,
1239933	,
1895039	,
306298	,
1964163	,
1111104	,
235563	,
1180552	,
1212986	,
1668041	,
1533998	,
1472479	,
1640534	,
1322710	,
1141641	,
1321115	,
1807703	,
2049980	,
314648	,
2080119	,
220435	,
1438532	,
411915	,
1017106	,
1023187	,
1498984	,
1214204	,
1684064	,
412669	,
412398	,
1917674	,
1092469	,
401777	,
1693671	,
1201015	,
1550791	,
1759443	,
1111888	,
224416	,
1741672	,
342506	,
401083	,
1671673	,
1232973	,
1287464	,
1912227	,
2113975	,
1904155	,
1642399	,
412680	,
1693673	,
1445583	,
1660521	,
1126998	,
412090	,
290022	,
1496277	,
1294207	,
1774497	,
1146719	,
230469	,
23665	,
1771778	,
287673	,
2079625	,
1038514	,
354088	,
239169	,
1198423	,
2087731	,
1802141	,
217160	,
1198059	,
1819293	,
1519176	,
1520998	,
1827911	,
1939576	,
1188459	,
271919	,
401750	,
1762182	,
1515205	,
1854252	,
1262954	,
411909	,
1494557	,
1198039	,
1141796	,
220709	,
1179720	,
1154237	,
1250262	,
1043249	,
1892660	,
412528	,
1028520	,
1825192	,
1064804	,
1385118	,
2091020	,
412160	,
1194051	,
1066240	,
1090882	,
1307135	,
1199980	,
1266162	,
1977512	,
2070628	,
1696831	,
1240560	,
1590762	,
2025661	,
1039746	,
1950326	,
2100059	,
200343	,
358531	,
1647223	,
1014644	,
1090193	,
1230362	,
1479397	,
1268945	,
210314	,
1521959	,
1048443	,
1889826	,
1058869	,
1244340	,
317347	,
200036	,
1730876	,
1456755	,
1232977	,
1762193	,
1779809	,
1220755	,
1088102	,
1567398	,
50664	,
2036964	,
1933322	,
1135508	,
401552	,
1904371	,
1225733	,
1434255	,
1143139	,
1129163	,
1256704	,
1697989	,
1985388	,
1146134	,
1112810	,
1798374	,
1114356	,
1148909	,
1922559	,
1190239	,
1222799	,
308493	,
1304724	,
1207579	,
263065	,
1174624	,
412120	,
1080824	,
1791574	,
2048818	,
1970383	,
2037809	,
411036	,
1484575	,
1220609	,
1300577	,
1723402	,
1827867	,
1504311	,
315487	,
1626223	,
1869040	,
1673767	,
238756	,
1851575	,
241793	,
1185666	,
242911	,
411141	,
1536704	,
1230196	,
1251917	,
1073443	,
1724538	,
1142929	,
1266381	,
411554	,
336771	,
1661224	,
1220454	,
2011441	,
1812968	,
1036348	,
1275832	,
1209658	,
1482757	,
1771758	,
1113295	,
303435	,
201279	,
316208	,
1971660	,
260344	,
1374357	,
1202300	,
316256	,
342483	,
1091476	,
275303	,
328968	,
1400261	,
1506730	,
1758747	,
221044	,
1351816	,
1059743	,
1148718	,
1835393	,
1262734	,
1632250	,
264678	,
1140528	,
1380716	,
1872516	,
1241764	,
1433073	,
1135826	,
234040	,
1486100	,
2084225	,
1141616	,
1106129	,
1185478	,
263851	,
216073	,
1173593	,
237738	,
1833945	,
299639	,
30134	,
296252	,
1218350	,
1034994	,
1682826	,
1046640	,
1242860	,
312432	,
1255195	,
212494	,
412046	,
1056433	,
218396	,
279670	,
1335943	,
1116523	,
1477923	,
1936564	,
1776542	,
1205294	,
1760291	,
296192	,
1231343	,
1079693	,
1196562	,
1058593	,
1060727	,
1278549	,
1343968	,
1238315	,
243084	,
2034512	,
248644	,
207373	,
1238738	,
1837521	,
1140040	,
1338550	,
1144144	,
2064075	,
1141841	,
1774776	,
1330825	,
1578350	,
1678650	,
412509	,
1435257	,
253604	,
1150228	,
1016684	,
1680815	,
401080	,
1430701	,
320765	,
1355806	,
1419563	,
1125618	,
1195833	,
1679495	,
345234	,
401696	,
1090892	,
411177	,
333877	,
305543	,
1211689	,
1621935	,
1239258	,
210467	,
1973926	,
1338382	,
1765606	,
1034460	,
1324282	,
203041	,
280851	,
2035637	,
2071901	,
1447321	,
278052	,
1089737	,
1897559	,
1685855	,
1016707	,
1215388	,
1872513	,
1372189	,
1271315	,
2067783	,
1561473	,
209456	,
1227024	,
1068836	,
1681405	,
244204	,
276337	,
1435583	,
1453996	,
1810250	,
1965241	,
1690974	,
241328	,
1380701	,
1810699	,
1820425	,
1345643	,
1779421	,
1040755	,
1140209	,
1239096	,
1753884	,
1494591	,
1085636	,
1202319	,
1156412	,
33082	,
251966	,
1466159	,
1292476	,
1266048	,
1168176	,
1804482	,
1348217	,
1324618	,
1283564	,
329924	,
2012803	,
411952	,
1122450	,
1168104	,
1373507	,
2045702	,
341963	,
218096	,
2014233	,
1801624	,
1220726	,
2131214	,
1210682	,
1941175	,
202559	,
1686253	,
2136723	,
1868004	,
1778094	,
1988990	,
1833555	,
1466779	,
1734095	,
1798629	,
1502082	,
1522580	,
1827389	,
1208645	,
1108218	,
1282984	,
1492701	,
2161878	,
1147956	,
2036548	,
2085455	,
1181657	,
1684742	,
216746	,
1701263	,
314856	,
1004252	,
1754998	,
231189	,
2161450	,
200795	,
412381	,
2144994	,
1252108	,
1766510	,
242410	,
1009632	,
219926	,
200621	,
2052811	,
412223	,
1156413	,
239127	,
1250252	,
1875796	,
1861955	,
1123580	,
1866247	,
2171154	,
2173827	,
2165932	,
1664632	,
1015007	,
1366218	,
2170120	,
2071519	,
2135457	,
220015	,
1241938	,
1888613	,
1212992	,
1189132	,
1166234	,
1909658	,
1057740	,
1786577	,
411329	,
1781690	,
1186289	,
1905955	,
1004081	,
1867278	,
1272547	,
412500	,
923707	,
1208886	,
296877	,
1746705	,
1434090	,
1114482	,
1226856	,
1014247	,
1006426	,
1516973	,
1068619	,
245780	,
1170414	,
1207754	,
1464788	,
1298662	,
1285312	,
1966566	,
1253874	,
2079019	,
360601	,
1520648	,
1197819	,
1150255	,
1755286	,
1178725	,
2182535	,
207085	,
1118223	,
2052156	,
1473257	,
1925138	,
1791408	,
200006	,
210307	,
1649984	,
1873700	,
1134658	,
1840258	,
1924269	,
2057644	,
1461911	,
2168293	,
2135885	,
1764300	,
1716288	,
1170946	,
7076	,
1746030	,
1371249	,
1293615	,
2128228	,
2014236	,
257930	,
1810126	,
307950	,
1775739	,
1102214	,
91889	,
216637	,
1815380	,
1373492	,
1441173	,
1757797	,
222482	,
412201	,
1186747	,
2012155	,
209312	,
1042083	,
1261028	,
1429320	,
1340979	,
2188129	,
2098295	,
1244714	,
1761782	,
401160	,
1123647	,
1480862	,
1920568	,
1908314	,
1534281	,
257880	,
2039391	,
2029631	,
1033318	,
1321101	,
1737997	,
1809208	,
1501211	,
1480160	,
1497139	,
2112196	,
1668042	,
1167397	,
1265898	,
1200764	,
1874837	,
1504781	,
1815379	,
1872880	,
277396	,
1251977	,
1046155	,
1701287	,
1172188	,
1126862	,
1663268	,
1119681	,
1669953	,
412517	,
2185259	,
1760197	,
1500880	,
1048578	,
430076	,
2085602	,
1482349	,
1280764	,
1971488	,
1550227	,
2139834	,
1515597	,
1248937	,
412644	,
1322211	,
344921	,
2042843	,
1047983	,
1031560	,
2026177	,
1824950	,
1965640	,
302344	,
1227947	,
2014237	,
1934760	,
2067510	,
411985	,
1102414	,
1170277	,
411794	,
2115910	,
1359721	,
1490431	,
2185863	,
411825	,
2196540	,
220450	,
1075806	,
308714	,
2119705	,
2197309	,
2198276	,
1240928	,
2215975	,
1761688	,
1969266	,
2224114	,
1923765	,
2150340	,
1181083	,
1237267	,
1741216	,
284097	,
2241822	,
2240297	,
2242433	,
304849	,
1784528	,
321647	,
2228395	,
2192973	,
1690383	,
2175895	,
2130092	,
2239059	,
1899365	,
1648708	,
2261845	,
2266693	,
2091665	,
1875800	,
1767955	,
2012942	,
1380734	,
1649933	,
2270260	,
2243107	,
412780	,
1789869	,
1761846	,
1114620	,
1167915	,
2011487	,
1695570	,
1921558	,
412531	,
1118779	,
2110697	,
1290262	,
411871	,
2041579	,
334290	,
1684074	,
2228467	,
1982470	,
2253270	,
213064	,
2224228	,
242933	,
401281	,
1015730	,
401764	,
2257347	,
2253831	,
2255945	,
2070868	,
1814054	,
1227156	,
1301218	,
1970656	,
1207572	,
331434	,
1126675	,
1321107	,
1740520	,
1028534	,
2224997	,
1466949	,
411242	,
1812311	,
1244343	,
1081032	,
1415993	,
1744395	,
1617501	,
1823315	,
1806545	,
215530	,
2228945	,
2258409	,
1677847	,
2234535	,
1712761	,
228260	,
1275476	,
2253187	,
411542	,
222523	,
2106718	,
1763544	,
1981722	,
1744768	,
1010726	,
1379687	,
272551	,
1823314	,
1084759	,
2239227	,
1560203	,
2224082	,
221797	,
2037239	,
1764935	,
1626714	,
1300591	,
411979	,
1693136	,
2274940	,
1298666	,
1807383	,
260991	,
1034469	,
411955	,
2288162	,
320651	,
1773763	,
1912297	,
1348870	,
1599335	,
1921511	,
1800538	,
2294341	,
2301983	,
2291952	,
2229199	,
2284940	,
2238921	,
2297982	,
2278555	,
2273745	,
2121582	,
1171964	,
2319408	,
2317774	,
2316490	,
2318460	,
2320052	,
2319465	,
1988818	,
1037541	,
2325346	,
2322441	,
2322921	,
2176286	,
2156058	,
1078677	,
2206703	,
1749946	,
2332981	,
2332931	,
1758752	,
411863	,
1870479	,
2321047	,
2308505	,
2278171	,
1071158	,
1683235	,
2147288	,
2233584	,
2141986	,
1212995	,
2330418	,
1391403	,
204313	,
1856223	,
2331177	,
302808	,
2137112	,
2273628	,
1840260	,
2222426	,
1104342	,
2271483	,
2273440	,
2237124	,
1820428	,
1377691	,
1154379	,
2021193	,
2194389	,
2347781	,
2153002	,
1694915	,
2348302	,
2356180	,
2202827	,
2319453	,
2358732	,
2362627	,
2363939	,
2373781	,
2371690	,
2370089	,
2378608	,
2380896	,
2278173	,
2386654	,
1488316	,
306262	,
2388621	,
2390715	,
2392841	,
2390348	,
2395953	,
2394490	,
2399123	,
1951427	,
2011679	,
2284301	,
44560	,
1793315	,
1824408	,
1967859	,
2238639	,
1964386	,
2162167	,
2306906	,
1154285	,
1247566	,
2214534	,
2285856	,
2268699	,
2288604	,
1722123	,
1379249	,
2128564	,
2286459	,
2226542	)


--non-retail_job_2.csv
--pre-bias_survey_2.csv
select c.SAP_PRTNR_ID, c.JOB_ABBREV_NM, c.CHIEF_FLAG,
(case when c.JOB_ABBREV_NM IN ('svp', 'evp', 'svp & gm', 'president', 'coo', 'chairman', 'cfo', 'ceo') then 'VP+'
    when c.JOB_ABBREV_NM = 'vp' then 'VP+'
    when c.JOB_ABBREV_NM = 'dir' then 'DIR'
    when c.JOB_ABBREV_NM = 'mgr sr' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'Y' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'N' then 'IC'
    when c.PAY_GRADE_CD IN('23','24') then 'IC'
    when CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) < 23 and  CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >0 then 'IC'
    when c.JOB_ABBREV_NM = 'cw' or c.EMP_STAT_CD = 'NonPartner Workforce' then 'CW'
    when c.JOB_ABBREV_NM = 'internship' then 'INTERN'
end) as JOB_GROUP 
 
from HPOHLMAN.ALL_POSN_CURRENT c
where c.SNAPSHOT_DT = (select max(SNAPSHOT_DT) from HPOHLMAN.ALL_POSN_CURRENT)
AND c.SAP_PRTNR_ID IN 
(1719272	,
2257284	,
216164	,
1160642	,
1534878	,
1852989	,
2122008	,
2374519	,
2341642	,
2237960	,
1258156	,
2027172	,
411848	,
2307387	,
2340317	,
1904165	,
2304924	,
2104787	,
1604095	,
1904668	,
1692404	,
1092933	,
1201746	,
1249099	,
1231339	,
2268749	,
1684457	,
273553	,
2417780	,
1940425	,
2417779	,
1773688	,
2352156	,
1361268	,
2428110	,
2423613	,
2430475	,
2446601	,
2445535	,
2453667	,
1058170	,
2458506	,
2384385	,
2463380	,
2399250	,
2429859	,
2390762	,
2423382	,
2231180	,
1966638	,
2446926	,
2460338	,
1825048	,
1313161	,
2026132	,
1199968	,
2320513	,
2361624	,
1247565	,
2476549	,
2479233	,
2204732	,
2220451	,
2478835	,
2473177	,
1342710	,
2440141	,
2468648	,
1904370	,
2420767	,
2372681	,
357071	,
2381723	,
2460059	,
1021584	,
219135	,
1638959	,
1080863	,
1813292	,
2389821	,
2477328	,
2015316	,
1939167	,
2399253	,
1690278	,
1064322	,
1580777	,
2338399	,
2366352	,
2050371	,
1258158	,
2466321	,
1891452	,
2111840	,
1034463	,
1953245	,
1647732	,
1450929	,
1369181	,
1843323	,
2009348	,
2414053	,
2468653	,
2294755	,
2053904	,
1874336	,
2398276	,
2246633	,
1986458	,
2459583	,
2136429	,
1739491	,
2404371	,
2122360	,
1045803	,
2148824	,
2270841	,
1075764	,
2386256	,
2221613	,
2105928	,
2422192	,
2338439	,
2446499	,
239241	,
1267884	,
2436980	,
1161228	,
1697395	,
2203065	,
1950728	,
2456191	,
1134841	,
1701401	,
1797556	,
1959952	,
2155587	,
2317427	,
200815	,
2373780	,
2275276	,
1889642	,
1239943	,
2331206	,
308439	,
2410212	,
2179625	,
1201638	,
2480756	,
2207774	,
2335294	,
2253242	,
1923705	,
2203312	,
1199618	,
1744463	,
1661227	,
1293230	,
1448815	,
1035260	,
2337901	,
1690180	,
2220219	,
1844815	,
2379404	,
1973728	,
2195264	,
1823662	,
2216242	,
1728557	,
1764617	,
273814	,
411548	,
1828462	,
1947473	,
2446093	,
1867188	,
1512541	,
1754351	,
1832615	,
1133699	,
2348260	,
1422553	,
1006394	,
2081864	,
2205511	,
1901524	,
1835376	,
1025919	,
1979899	,
1957324	,
2484919	,
1979501	,
1036460	,
2460180	,
2332935	,
1673422	,
2340339	,
2363924	,
1959361	,
1744999	,
2042091	,
2374793	,
2293470	,
2481022	,
2079585	,
1028164	,
2357935	,
1817969	,
1236095	,
2362282	,
2256470	,
430079	,
1505848	,
1100918	,
1496595	,
401061	,
2391516	,
1168135	,
1744981	,
1426652	,
1070092	,
2309008	,
1642397	,
1740927	,
2390755	,
348681	,
2332389	,
2208224	,
1364766	,
2249946	,
2270994	,
2353045	,
2226235	,
2438689	,
2482294	,
2473118	,
1284616	,
1968781	,
2355398	,
2423259	,
2408599	,
1841248	,
1847990	,
2468082	,
2192566	,
2366103	,
1448629	,
2381722	,
2479570	,
2348916	,
2467935	,
2394063	,
1814439	,
2265453	,
1966898	,
2331153	,
2323859	,
2353804	,
2486713	,
1869132	,
1852636	,
2369150	,
2045659	,
1743266	,
1833697	,
1416847	,
2468083	,
2086221	,
2160432	,
1112699	,
1973525	,
2428106	,
2097915	,
2390444	,
1343385	,
1681696	,
1749732	,
2327155	,
1382930	,
2450160	,
2190871	,
2144604	,
1495792	,
1107448	,
1863699	,
2234267	,
1927220	,
1914659	,
1487352	,
1143796	,
2039568	,
2364970	,
2043932	,
2377942	,
1813408	,
2359906	,
2235524	,
2150338	,
2013468	,
1892316	,
1006061	,
1141563	,
2266016	,
1622292	,
412486	,
2205206	,
1393721	,
1428449	,
1190462	,
2119839	,
2462440	,
2449161	,
2274361	,
411610	,
2184522	,
2418668	,
2333195	,
1679384	,
1768400	,
2457910	,
1763685	,
1967414	,
2466800	,
2053816	,
2474513	,
1893308	,
2443662	,
2223005	,
2184535	,
2182565	,
1965346	,
2185722	,
2463856	,
1297368	,
2376105	,
1322563	,
1016014	,
221287	,
2110097	,
1251633	,
1823313	,
2084227	,
1453812	,
411463	,
1171840	,
1011220	,
2390739	,
2122361	,
2183544	,
2358730	,
1753956	,
2163243	,
1382922	,
2161543	,
1143973	,
2366101	,
2152963	,
2294409	,
2387360	,
1268501	,
2049981	,
1109887	,
1185665	,
1474993	,
2204549	,
2262649	,
1090440	,
2499196	,
2495966	,
2498919	,
2489905	,
2501432	,
2498799	,
2048350	,
2498603	,
2510331	)



--non-retail_job_3.csv
--post-bias_survey_1.csv
select c.SAP_PRTNR_ID, c.JOB_ABBREV_NM, c.CHIEF_FLAG,
(case when c.JOB_ABBREV_NM IN ('svp', 'evp', 'svp & gm', 'president', 'coo', 'chairman', 'cfo', 'ceo') then 'VP+'
    when c.JOB_ABBREV_NM = 'vp' then 'VP+'
    when c.JOB_ABBREV_NM = 'dir' then 'DIR'
    when c.JOB_ABBREV_NM = 'mgr sr' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'Y' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'N' then 'IC'
    when c.PAY_GRADE_CD IN('23','24') then 'IC'
    when CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) < 23 and  CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >0 then 'IC'
    when c.JOB_ABBREV_NM = 'cw' or c.EMP_STAT_CD = 'NonPartner Workforce' then 'CW'
    when c.JOB_ABBREV_NM = 'internship' then 'INTERN'
end) as JOB_GROUP 
 
from HPOHLMAN.ALL_POSN_CURRENT c
where c.SNAPSHOT_DT = (select max(SNAPSHOT_DT) from HPOHLMAN.ALL_POSN_CURRENT)
AND c.SAP_PRTNR_ID IN 
(412039	,
1786386	,
1834186	,
2094405	,
1964190	,
1495793	,
1797736	,
1962750	,
1937952	,
2056922	,
2039245	,
401636	,
1434570	,
2064079	,
1074086	,
1104665	,
1130862	,
1800418	,
267300	,
1509416	,
2047780	,
1840623	,
1722208	,
1161065	,
1362242	,
1329755	,
1718092	,
267556	,
1279161	,
1057312	,
1297107	,
1955343	,
283764	,
327191	,
1237277	,
1417498	,
1095910	,
1121589	,
1329552	,
200386	,
2063113	,
1354430	,
1845988	,
1057524	,
1772448	,
1226484	,
1765576	,
1174305	,
1678499	,
1204633	,
1756874	,
353321	,
1316966	,
1921514	,
1679849	,
2086223	,
223604	,
1713763	,
213326	,
1202572	,
1836094	,
1754119	,
1811902	,
1114810	,
1839080	,
1128524	,
15024	,
1972373	,
1239933	,
1895039	,
306298	,
1964163	,
1111104	,
235563	,
1180552	,
1212986	,
1668041	,
1144143	,
1131865	,
1533998	,
1679791	,
263520	,
1809770	,
1694917	,
232914	,
440170	,
2037890	,
1305875	,
1472479	,
1892556	,
1346951	,
412346	,
359081	,
1132164	,
1640534	,
1344614	,
1322710	,
1145417	,
1265527	,
1141641	,
1321115	,
1807703	,
2080119	,
220435	,
1812537	,
411924	,
411915	,
1027653	,
1017106	,
1023187	,
1498984	,
1214204	,
412398	,
1084156	,
1917674	,
1092469	,
1812312	,
401777	,
1021331	,
1550481	,
1693671	,
1201015	,
1208890	,
1550791	,
1759443	,
1227401	,
1111888	,
2014124	,
342506	,
401083	,
1671673	,
1232973	,
1287464	,
1912227	,
1563115	,
2113975	,
1904155	,
1642399	,
412680	,
1693673	,
1252198	,
1445583	,
1660521	,
1126998	,
412090	,
290022	,
1892935	,
306123	,
1496277	,
1496249	,
1294207	,
1774497	,
1146719	,
272306	,
230469	,
269389	,
1514202	,
1298262	,
23665	,
287673	,
2079625	,
1134701	,
1038514	,
412304	,
1841479	,
354088	,
1382902	,
239169	,
1653158	,
2112450	,
1683811	,
1802141	,
257530	,
1119667	,
1256906	,
233037	,
1198059	,
1819293	,
1520998	,
2067127	,
1275159	,
1066964	,
1442040	,
1124131	,
1827911	,
1939576	,
1188459	,
271919	,
1762182	,
1515205	,
260880	,
1854252	,
411909	,
1494557	,
1141796	,
1769443	,
220709	,
1684746	,
1179720	,
1154237	,
1250262	,
1043249	,
1193755	,
1892660	,
1245233	,
412528	,
1028520	,
1825192	,
1137911	,
1079208	,
411704	,
1064804	,
1385118	,
1343555	,
2084775	,
2091020	,
412160	,
242344	,
221614	,
1871840	,
1194051	,
1066240	,
1090882	,
1307135	,
1266162	,
1042354	,
1977512	,
1178313	,
2070628	,
238580	,
1240560	,
2097748	,
1590762	,
2025661	,
2063148	,
1039746	,
247194	,
1950326	,
2100059	,
1137612	,
200343	,
358531	,
1647223	,
1014644	,
411228	,
1230362	,
1021076	,
1479397	,
1851565	,
210314	,
1072528	,
1071078	,
1521959	,
1545413	,
1048443	,
1889826	,
1244340	,
317347	,
200036	,
2020838	,
1285673	,
1730876	,
1867156	,
1336813	,
1456755	,
1838791	,
1762193	,
75201	,
1779809	,
1220755	,
1815634	,
1088102	,
1567398	,
1319124	,
219513	,
50664	,
271960	,
1826195	,
1083239	,
1185064	,
1933322	,
1170176	,
1211126	,
1099801	,
1481823	,
401552	,
1738139	,
1876343	,
295968	,
1293367	,
1904371	,
1225733	,
1434255	,
2101985	,
1073096	,
1129163	,
314198	,
1256704	,
1389526	,
1399773	,
1697989	,
1158335	,
1659238	,
1146134	,
1645160	,
1562160	,
1112810	,
1798374	,
1740528	,
1114356	,
1049959	,
1136803	,
1821598	,
1148909	,
1379206	,
1922559	,
1190239	,
1222799	,
1166282	,
218233	,
308493	,
1284624	,
1304724	,
1207579	,
296460	,
1280500	,
263065	,
1174624	,
412120	,
1713019	,
1080824	,
1970383	,
2037809	,
411036	,
1654829	,
1224488	,
1484575	,
1300577	,
1723402	,
1827867	,
1504311	,
315487	,
1626223	,
1067345	,
1314797	,
1869040	,
1673767	,
238756	,
1372760	,
1185666	,
1142173	,
411141	,
411512	,
1184085	,
1536704	,
1322210	,
1251917	,
1855555	,
1073443	,
1142929	,
1432328	,
1266381	,
411554	,
1661224	,
1220454	,
1812968	,
1277115	,
1036348	,
1275832	,
1209658	,
1482757	,
1398213	,
1688226	,
1113295	,
303435	,
201279	,
316208	,
1040154	,
1228580	,
1971660	,
1075400	,
1757774	,
260344	,
330205	,
1834219	,
1670436	,
1202300	,
316256	,
342483	,
1091476	,
275303	,
328968	,
1686110	,
1400261	,
1506730	,
1758747	,
1750222	,
221044	,
201714	,
1636071	,
1340408	,
1059743	,
1148718	,
1202315	,
1178186	,
1835393	,
411941	,
1632250	,
1205534	,
1244286	,
1140528	,
1996898	,
1380716	,
1872516	,
1892193	,
1379197	,
217536	,
1241764	,
1769031	,
1793795	,
1173609	,
1697434	,
1433073	,
1679496	,
234040	,
57563	,
214208	,
1213806	,
210979	,
1141616	,
1179910	,
1018844	,
1957274	,
1933609	,
323283	,
2044863	,
1185478	,
263851	,
216073	,
1407184	,
1715006	,
1922846	,
1693081	,
1263002	,
238718	,
1262951	,
1549549	,
221671	,
1205517	,
1833945	,
299639	,
30134	,
1341596	,
296252	,
1218350	,
1198913	,
1034994	,
203029	,
1682826	,
1046640	,
440006	,
250335	,
312432	,
1255195	,
212494	,
1056433	,
218396	,
1129729	,
1792654	,
1335943	,
312886	,
1751003	,
1503083	,
1664745	,
1116523	,
251345	,
1477923	,
1182051	,
1936564	,
292935	,
1326997	,
1776542	,
1205294	,
284324	,
1760291	,
296192	,
1745585	,
318643	,
1380733	,
1079693	,
1206089	,
1058593	,
401204	,
1379229	,
1060727	,
1671354	,
1278549	,
2038901	,
1975560	,
1343968	,
1238315	,
243084	,
1041591	,
412396	,
2034512	,
248644	,
1238738	,
1140040	,
1144144	,
1761223	,
2064075	,
412345	,
1645495	,
73500	,
210125	,
2100026	,
1774776	,
1252704	,
1871240	,
209193	,
1150260	,
1288209	,
1578350	,
1139169	,
1778539	,
412509	,
1818127	,
1742441	,
1435257	,
253604	,
1850362	,
1150228	,
1016684	,
1680815	,
401080	,
1224688	,
223792	,
1382532	,
1430701	,
320765	,
412327	,
1355806	,
1419563	,
1125618	,
356687	,
1949870	,
1195833	,
345234	,
1847602	,
1694564	,
401696	,
1090892	,
411177	,
2077563	,
333877	,
305543	,
332225	,
1211689	,
1476972	,
1239258	,
1053612	,
1598670	,
210467	,
1744893	,
1741671	,
1973926	,
1338382	,
1310445	,
1134558	,
1626675	,
1765606	,
1802188	,
1402356	,
214418	,
1027123	,
1034460	,
1324282	,
311362	,
1196125	,
1829485	,
203041	,
280851	,
201607	,
1065111	,
2035637	,
1447321	,
1207153	,
1326427	,
278052	,
1986793	,
1089737	,
1897559	,
1798417	,
1143386	,
1808427	,
1685855	,
1812048	,
1186774	,
1799136	,
1210389	,
2051827	,
1794845	,
1039529	,
1016707	,
1903217	,
1151559	,
1050677	,
1872513	,
219815	,
1130755	,
1279904	,
1372189	,
1066536	,
1271315	,
1171836	,
1199427	,
1115300	,
1324380	,
1681773	,
2067783	,
1963426	,
1951685	,
1875434	,
1561473	,
1156050	,
209456	,
228126	,
1227024	,
1159430	,
1068836	,
244204	,
1723455	,
2012995	,
1876044	,
211286	,
1435583	,
1453996	,
1965241	,
1457349	,
1690974	,
1529147	,
268786	,
1300240	,
1355836	,
1509030	,
241328	,
1380701	,
249398	,
1340987	,
1820425	,
1345643	,
1671345	,
1359744	,
1779421	,
1040755	,
1791416	,
1750221	,
1876341	,
1140209	,
2131259	,
1753884	,
1494591	,
1202319	,
1342239	,
1156412	,
1926633	,
1217281	,
2051743	,
33082	,
279121	,
251966	,
1466159	,
1292476	,
401056	,
1008086	,
1266048	,
1756152	,
1453809	,
2134509	,
1865840	,
2016955	,
1804482	,
1348217	,
1324618	,
2111929	,
1253315	,
1898550	,
313959	,
215698	,
314425	,
1283564	,
329924	,
1530947	,
1758464	,
2107563	,
1103446	,
2012803	,
1374210	,
411952	,
1353698	,
14807	,
287877	,
1168104	,
1373507	,
2045702	,
1974900	,
2054641	,
218096	,
1322226	,
329934	,
1048355	,
1242868	,
2095315	,
233055	,
1031287	,
1126581	,
2014233	,
1801624	,
1233228	,
278185	,
1220726	,
321863	,
319537	,
2068133	,
1046774	,
2029293	,
1210682	,
1941175	,
202559	,
1295090	,
1686253	,
1141456	,
1841051	,
1868004	,
222421	,
1778094	,
1744207	,
1988990	,
31409	,
1833555	,
1978178	,
1808295	,
2019272	,
1762066	,
1778092	,
1169253	,
1436108	,
1466779	,
1047319	,
1734095	,
312186	,
1798629	,
1909782	,
1504050	,
1514768	,
1502082	,
1827389	,
1531515	,
1372019	,
1208645	,
1108218	,
1282984	,
1492701	,
2161878	,
1212461	,
1147956	,
1188453	,
1565412	,
2085455	,
1684742	,
1823749	,
1695767	,
1701263	,
314856	,
1108077	,
1256011	,
1004252	,
1809454	,
1939074	,
412381	,
2144994	,
1264578	,
1483047	,
1252108	,
1762793	,
1766510	,
1009632	,
219926	,
412223	,
2116681	,
1156418	,
2022877	,
1156413	,
1931544	,
411212	,
1560408	,
1807327	,
1504038	,
1250252	,
1228513	,
1875796	,
1812538	,
1861955	,
1228122	,
1432318	,
1840570	,
1541740	,
1254903	,
1170181	,
1123580	,
1378212	,
1155708	,
1217030	,
1823395	,
1866247	,
2171154	,
1876891	,
2173827	,
2165932	,
1664632	,
2093637	,
1944176	,
1015007	,
2050333	,
1366218	,
2170120	,
2071519	,
2135457	,
220015	,
1765894	,
1750167	,
1166594	,
1061045	,
1112648	,
1241938	,
1888613	,
1294511	,
1212992	,
1187677	,
1189132	,
1166234	,
1909658	,
350780	,
1786577	,
1416345	)


--non-retail_job_4.csv
--post-bias_survey_2.csv
select c.SAP_PRTNR_ID, c.JOB_ABBREV_NM, c.CHIEF_FLAG,
(case when c.JOB_ABBREV_NM IN ('svp', 'evp', 'svp & gm', 'president', 'coo', 'chairman', 'cfo', 'ceo') then 'VP+'
    when c.JOB_ABBREV_NM = 'vp' then 'VP+'
    when c.JOB_ABBREV_NM = 'dir' then 'DIR'
    when c.JOB_ABBREV_NM = 'mgr sr' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'Y' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'N' then 'IC'
    when c.PAY_GRADE_CD IN('23','24') then 'IC'
    when CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) < 23 and  CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >0 then 'IC'
    when c.JOB_ABBREV_NM = 'cw' or c.EMP_STAT_CD = 'NonPartner Workforce' then 'CW'
    when c.JOB_ABBREV_NM = 'internship' then 'INTERN'
end) as JOB_GROUP 
 
from HPOHLMAN.ALL_POSN_CURRENT c
where c.SNAPSHOT_DT = (select max(SNAPSHOT_DT) from HPOHLMAN.ALL_POSN_CURRENT)
AND c.SAP_PRTNR_ID IN 
(1671900	,
1655435	,
216280	,
1781690	,
1905955	,
1455070	,
1004081	,
1675335	,
1867278	,
1683679	,
1272547	,
1277155	,
1457847	,
1742431	,
412500	,
1018843	,
2006	,
2174819	,
1002750	,
1913344	,
923707	,
1312622	,
353998	,
1208886	,
2053907	,
296877	,
2162969	,
1132524	,
1966636	,
2106858	,
1360011	,
1746705	,
1509477	,
1434090	,
1229579	,
1677458	,
1114482	,
1226856	,
1123750	,
1803692	,
1835998	,
1080146	,
1024714	,
1014247	,
1090635	,
1006426	,
307421	,
1516973	,
1068619	,
245780	,
1667400	,
1170414	,
1207754	,
1464788	,
1233497	,
1191324	,
1966566	,
1253874	,
1143143	,
2079019	,
360601	,
1750787	,
1520648	,
1973552	,
1282652	,
1755286	,
1178725	,
2182535	,
1972688	,
1776272	,
1929749	,
1770730	,
207085	,
1473257	,
1925138	,
1791408	,
2063465	,
1409176	,
200006	,
1843468	,
210307	,
1649984	,
1734821	,
286381	,
1873700	,
1134658	,
1104658	,
1840258	,
1695594	,
1336528	,
2171977	,
1024715	,
1254261	,
201075	,
1702144	,
2168293	,
2135885	,
1810098	,
1716288	,
1643130	,
1078262	,
7076	,
1866384	,
1746030	,
1117483	,
2179627	,
1371249	,
309232	,
1293615	,
2128228	,
1231712	,
2014236	,
1209647	,
257930	,
1733581	,
2011821	,
1425185	,
1382257	,
1775739	,
1102214	,
91889	,
1818881	,
216637	,
1815380	,
305949	,
1786498	,
1721823	,
1124435	,
1079533	,
1441173	,
210437	,
222482	,
1094828	,
1783170	,
412201	,
1985342	,
1222420	,
1494175	,
1685420	,
1194075	,
2012155	,
1379688	,
1876254	,
209312	,
1041409	,
2034513	,
1042083	,
212914	,
1261028	,
1746866	,
1361060	,
430107	,
1429320	,
1835651	,
1771774	,
412091	,
2188129	,
2098295	,
1224711	,
1244714	,
1199641	,
1761782	,
2186389	,
1515540	,
401160	,
1480862	,
1920568	,
1908314	,
1534281	,
400415	,
2053908	,
2156157	,
311057	,
1687877	,
2039391	,
2029631	,
28007	,
1256483	,
1132951	,
2139941	,
1888105	,
1033318	,
222628	,
1995167	,
1400582	,
1321101	,
1737997	,
1214831	,
1452660	,
1872274	,
2153464	,
1945341	,
1480160	,
1497139	,
1593267	,
2112196	,
1074628	,
1668042	,
257220	,
1167397	,
1200764	,
1874837	,
238068	,
1504781	,
1815379	,
1357333	,
1712760	,
412583	,
1872880	,
277396	,
1251977	,
1046155	,
1926735	,
1701287	,
2190872	,
1172188	,
1126862	,
1663268	,
1876569	,
1119681	,
1669953	,
1848575	,
412637	,
2012802	,
2100204	,
1787995	,
1348354	,
1739519	,
412517	,
2185259	,
1760197	,
1500880	,
328197	,
1048578	,
430076	,
2035343	,
354325	,
1023347	,
1482349	,
1813371	,
1214221	,
280545	,
1280764	,
1971488	,
282108	,
1233448	,
1550227	,
2080393	,
401374	,
2139834	,
1695983	,
320248	,
1915802	,
1167199	,
1515597	,
1248937	,
1767891	,
1322211	,
344921	,
1863935	,
1047983	,
2024067	,
1562171	,
1031560	,
2026177	,
1025211	,
1824950	,
1319104	,
1604903	,
1197825	,
1965640	,
1232107	,
1142032	,
302344	,
1227947	,
2014237	,
1867190	,
2067510	,
2067874	,
206951	,
411985	,
1102414	,
1570700	,
1944726	,
411794	,
2115910	,
1359721	,
271453	,
1490431	,
1343974	,
295332	,
2068035	,
2185863	,
411825	,
1185800	,
2196540	,
1761486	,
1922193	,
2012426	,
220450	,
1380724	,
308714	,
2188793	,
2119705	,
2197309	,
2198276	,
1109133	,
1902062	,
1240928	,
1403343	,
281772	,
2212284	,
2113275	,
2215975	,
1043447	,
1969266	,
1510486	,
2187189	,
1678224	,
1431505	,
2068287	,
2224114	,
2223966	,
1101297	,
1817917	,
2044862	,
1725852	,
2223680	,
1467688	,
1237267	,
1527066	,
2228083	,
1741216	,
2229660	,
284097	,
255112	,
2241822	,
2240297	,
281255	,
2242433	,
2243898	,
1213543	,
401736	,
2253228	,
1389994	,
304849	,
1784528	,
1742788	,
321647	,
1989116	,
2228395	,
2192973	,
1690383	,
1947471	,
1242587	,
412777	,
2138395	,
1140195	,
1107915	,
2175895	,
2130092	,
1723964	,
2023198	,
2239059	,
1899365	,
1648708	,
2184521	,
2193342	,
411707	,
2261845	,
2266693	,
2215498	,
1875800	,
1380734	,
1649933	,
1594296	,
2179938	,
2270260	,
2241819	,
1935829	,
1591685	,
2253823	,
1482350	,
255801	,
1337416	,
412780	,
1827088	,
1114227	,
1851620	,
1789869	,
1969264	,
1114620	,
1190626	,
1167915	,
217949	,
2011487	,
1695570	,
1414750	,
2105122	,
2132846	,
1921558	,
1101146	,
2240692	,
412531	,
1118779	,
1681780	,
2269086	,
2097973	,
1290262	,
2268700	,
2210657	,
411871	,
2041579	,
1128536	,
1375040	,
334290	,
2196511	,
2125306	,
1684074	,
2228467	,
1982470	,
1896230	,
228505	,
2224228	,
2208400	,
1975559	,
440111	,
401281	,
1813467	,
1015730	,
1579590	,
2122650	,
1244184	,
260751	,
2257347	,
2253831	,
1292552	,
1895659	,
2070868	,
1814054	,
1141624	,
2100501	,
411211	,
1541356	,
1496240	,
2021286	,
1227156	,
1197208	,
1244716	,
1301218	,
1970656	,
400199	,
1765338	,
1865435	,
1207572	,
1239457	,
1058574	,
1033665	,
1670442	,
1779419	,
331434	,
1451606	,
1126675	,
359261	,
2194386	,
1321107	,
1740520	,
1976584	,
1787875	,
1743223	,
1028534	,
2224997	,
2248072	,
1812311	,
1244343	,
2196268	,
1997593	,
2244391	,
1153779	,
1760506	,
1081032	,
1415993	,
400271	,
1744395	,
1047144	,
1617501	,
440051	,
1329254	,
1806545	,
215530	,
1259841	,
2228945	,
2011434	,
2258409	,
412743	,
1677847	,
2129598	,
1320485	,
1965642	,
2234535	,
1133884	,
1712761	,
228260	,
1141479	,
1956729	,
440043	,
1593082	,
1275476	,
2253187	,
1874626	,
411542	,
222523	,
1895235	,
2106718	,
1763544	,
1981722	,
2274941	,
269088	,
1695623	,
1744768	,
1010726	,
1942905	,
2089753	,
1379687	,
1762991	,
1113560	,
1171228	,
338042	,
272551	,
1795717	,
1823314	,
2209921	,
2239227	,
1560203	,
2224082	,
1776324	,
2037239	,
2258907	,
1764935	,
1626714	,
1207062	,
1300591	,
341126	,
1308409	,
1193343	,
1077950	,
1693136	,
2274940	,
1100919	,
257872	,
2233539	,
1319123	,
1695900	,
2017415	,
1736324	,
1832796	,
411955	,
1727940	,
1865762	,
2277801	,
2288603	,
2283186	,
2288162	,
1698928	,
1912297	,
1348870	,
1921511	,
2070422	,
1800538	,
2301983	,
2291952	,
2270263	,
2284940	,
2238921	,
2098204	,
2278555	,
2281397	,
2273745	,
1171964	,
2270889	,
2216708	,
2317446	,
2319408	,
2313631	,
2316490	,
2318460	,
2320052	,
2266523	,
1988818	,
1378410	,
1949871	,
2322441	,
2322921	,
2257337	,
2328603	,
2325178	,
2328488	,
2329523	,
1078677	,
2171389	,
2206703	,
2201683	,
1025245	,
2151397	,
2332931	,
2029250	,
2122738	,
1758752	,
411863	,
1870479	,
2075141	,
2336420	,
1184027	,
1116894	,
1088123	,
2321047	,
2278171	,
1071158	,
1683235	,
2141986	,
2330418	,
2122006	,
261998	,
1391403	,
411335	,
204313	,
1856223	,
2148143	,
2331177	,
302808	,
1935797	,
2137112	,
1835327	,
1840260	,
2209250	,
2216225	,
1904613	,
2158525	,
2240688	,
2278172	,
2069742	,
1713965	,
1116781	,
2222426	,
1104342	,
1754185	,
264618	,
1023504	,
2122737	,
1934759	,
2271483	,
2273440	,
1807382	,
2237124	,
2266728	,
1171439	,
2168529	,
1820428	,
1377691	,
2118965	,
1154379	,
1679837	,
2269928	,
346323	,
2203051	,
2342397	,
1300596	,
2346889	,
2347781	,
2264225	,
2350420	,
2258358	,
1793542	,
2099700	,
1694915	,
2348302	,
228615	,
2357579	,
2353472	,
2356180	,
2319453	,
2358732	,
2362659	,
2366039	,
2361252	,
2359881	,
2373781	,
2371690	,
2375678	,
2376328	,
2370089	,
2378608	,
2379985	,
2380896	,
2380441	,
401386	,
2278173	,
2384739	,
2386654	,
1488316	,
1258306	,
306262	,
2388621	,
2390715	,
2392841	,
2390348	,
2334790	,
2394064	,
2395953	,
2394756	,
2253805	,
2398273	,
2394490	,
2402902	,
2399123	,
1951427	,
2193245	,
2011679	,
2303007	,
44560	,
1793315	,
2256471	,
1824408	,
2238639	,
1487359	,
1964386	,
1992519	,
2162167	,
2306906	,
1154285	,
1766719	,
2214534	,
2285856	,
2268699	,
2288604	,
1722123	,
1931856	,
2239228	,
1379249	,
2128564	,
2286459	,
2369188	,
1719272	,
2310445	,
216164	,
1679102	,
1160642	,
2244643	,
2002082	,
1534878	,
1796262	,
2403252	,
1852989	,
1806953	,
1684906	,
2122008	,
2340573	,
2374519	,
2338968	,
1790318	,
1352507	,
247556	,
2341642	,
2237960	,
2273372	,
1258156	,
2027172	,
1819335	,
411848	,
2307387	,
1904165	,
412127	,
2304924	,
1583472	,
1288296	,
2377447	,
1756063	,
1904668	,
1692404	,
1092933	,
1378436	,
1201746	,
1570233	,
1249099	,
2284960	,
273553	,
2417780	,
400214	,
2380361	,
2417779	,
2405131	,
2352156	,
2414054	,
321893	,
2406740	,
2421214	,
2428110	,
2430475	,
2427516	,
2430680	,
2432282	,
2102915	,
2434136	,
1379987	,
2053903	,
2336421	,
2449160	,
1233455	,
2446601	,
2417086	,
2338969	,
2456983	,
2453667	,
1058170	,
2384385	,
2463380	,
258364	,
2437318	,
2429859	,
1200746	,
2423382	,
2231180	,
1868957	,
1066527	,
1981200	,
2446926	,
2460338	,
1825048	,
2339770	,
1313161	,
1143389	,
2026132	,
1199968	,
1080634	,
2320513	,
2472453	,
2361624	,
2472887	,
2471987	,
2475861	,
2476549	,
2474514	,
2072010	,
2461366	,
2220451	,
2353139	,
1266377	,
1255579	,
2478835	,
2473177	,
1830529	,
2329773	,
1342710	,
1759209	,
1456989	,
2440141	,
202149	,
1482483	,
2468648	,
2490545	,
1904370	,
1898747	,
2420767	,
2099295	,
1025312	,
2450081	,
2397481	,
356606	,
1786815	,
357071	,
1375492	,
205295	,
2381723	,
2042984	,
2386409	,
1213370	,
1021584	,
219135	,
1824615	,
2015316	,
1205324	,
1939167	,
1686966	,
1683684	,
1690278	,
2236612	,
1692018	,
1064322	,
2237150	,
1580777	,
2361626	,
1660548	,
2480754	,
2366352	,
2338967	,
1730683	,
2050371	,
2430486	,
1258158	,
2466321	,
246401	,
1891452	,
2111840	,
1034463	,
1647732	,
1512546	,
1450929	,
1969976	,
1369181	,
2362262	,
1215411	,
2148483	,
2428156	,
2262275	,
2468653	,
1792298	,
2053904	,
1874336	,
2398276	,
2246633	,
1986458	,
1804232	,
1319730	,
1930803	,
2373679	,
2459583	,
2425491	,
2136429	,
1739491	,
2404371	,
2409651	)



--post-bias_survey_3.csv
select c.SAP_PRTNR_ID, c.JOB_ABBREV_NM, c.CHIEF_FLAG,
(case when c.JOB_ABBREV_NM IN ('svp', 'evp', 'svp & gm', 'president', 'coo', 'chairman', 'cfo', 'ceo') then 'VP+'
    when c.JOB_ABBREV_NM = 'vp' then 'VP+'
    when c.JOB_ABBREV_NM = 'dir' then 'DIR'
    when c.JOB_ABBREV_NM = 'mgr sr' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'Y' then 'MGR'
    when (c.JOB_ABBREV_NM = 'manager' or CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >= 25) and c.CHIEF_FLAG = 'N' then 'IC'
    when c.PAY_GRADE_CD IN('23','24') then 'IC'
    when CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) < 23 and  CAST(REGEXP_REPLACE(c.PAY_GRADE_CD, '[^0-9]+', '') AS number) >0 then 'IC'
    when c.JOB_ABBREV_NM = 'cw' or c.EMP_STAT_CD = 'NonPartner Workforce' then 'CW'
    when c.JOB_ABBREV_NM = 'internship' then 'INTERN'
end) as JOB_GROUP 
 
from HPOHLMAN.ALL_POSN_CURRENT c
where c.SNAPSHOT_DT = (select max(SNAPSHOT_DT) from HPOHLMAN.ALL_POSN_CURRENT)
AND c.SAP_PRTNR_ID IN 
(2122360	,
1045803	,
2477877	,
2148824	,
2270841	,
1075764	,
2386256	,
2105928	,
2247462	,
2422192	,
2485354	,
412461	,
2248073	,
2338439	,
2446499	,
1267884	,
2456857	,
2436980	,
2486335	,
1161228	,
1697395	,
2151136	,
2203065	,
501526	,
1950728	,
2456191	,
1134841	,
2346606	,
1701401	,
2228082	,
1799134	,
1695569	,
2334854	,
261446	,
2357204	,
1797556	,
2209252	,
1959952	,
2483515	,
1457000	,
2155587	,
2308185	,
2198421	,
2187776	,
273797	,
2369180	,
2317427	,
200815	,
1950055	,
1241617	,
1824236	,
1077664	,
2226359	,
2486078	,
1889642	,
1878156	,
2061927	,
2488222	,
1239943	,
2331206	,
1746401	,
1792205	,
1347330	,
1749078	,
1888007	,
2410212	,
2179625	,
1201638	,
1317908	,
2446090	,
1953809	,
1237429	,
2480756	,
2030726	,
2207774	,
2020613	,
2278854	,
2335294	,
2203312	,
1199618	,
1744463	,
1118326	,
2117355	,
1448815	,
2119869	,
1395636	,
1035260	,
2337901	,
1428327	,
400244	,
1690180	,
2386606	,
2365300	,
2188397	,
1462726	,
1125248	,
221176	,
2220219	,
400179	,
1844815	,
1209204	,
2078271	,
1973728	,
1218726	,
1863044	,
2195264	,
1089491	,
2472892	,
2216242	,
2329234	,
2444772	,
1728557	,
2395051	,
1764617	,
1650178	,
2410651	,
273814	,
2344326	,
411548	,
306595	,
1828462	,
1947473	,
412652	,
2201819	,
1515543	,
1318859	,
1867188	,
1512541	,
1013868	,
1754351	,
1733046	,
1832615	,
1133699	,
1903085	,
2348260	,
1422553	,
1597344	,
1006394	,
231826	,
2081864	,
2470713	,
2205511	,
2405158	,
1901524	,
1835376	,
2110558	,
1979289	,
2349998	,
1979899	,
1957324	,
2484919	,
2460180	,
1270335	,
2272333	,
2362658	,
1163183	,
2326859	,
1006069	,
1189122	,
1673422	,
2340339	,
2363924	,
2408896	,
2170630	,
1839050	,
2042091	,
2293470	,
2457909	,
2333466	,
1965886	,
2079585	,
1028164	,
2357935	,
1817969	,
2377696	,
1236095	,
2362282	,
2256470	,
2485353	,
1647535	,
2343862	,
430079	,
2414889	,
2093267	,
2488549	,
1873087	,
1100918	,
1070607	,
1026495	,
2463679	,
1219769	,
1496595	,
2228326	,
2031708	,
1300578	,
282211	,
1744981	,
412655	,
1426652	,
1070092	,
2309008	,
1642397	,
1740927	,
2413545	,
2051744	,
1273583	,
1699876	,
1380006	,
2363535	,
348681	,
1201662	,
2332389	,
2208224	,
2484921	,
2364721	,
1653519	,
1239514	,
1989514	,
2249946	,
2485543	,
2270994	,
2353045	,
2226235	,
1972803	,
2226825	,
2438689	,
2482294	,
2467122	,
2473118	,
2333467	,
1432578	,
2253232	,
2269089	,
1284616	,
1968781	,
1812875	,
2355398	,
2134508	,
2009343	,
1476326	,
1824673	,
2423259	,
1841248	,
2468082	,
1849757	,
2418445	,
2228086	,
2348305	,
2012123	,
2192566	,
2366103	,
1448629	,
1515218	,
1980902	,
2479570	,
2348916	,
2292076	,
2080278	,
2467935	,
2394063	,
2280811	,
201979	,
1814439	,
2265453	,
1585022	,
2124681	,
2368930	,
1184030	,
2323859	,
2353804	,
2486713	,
2488547	,
1852636	,
1712479	,
1605061	,
1692095	,
2486334	,
2369150	,
2045659	,
2338092	,
1416847	,
2468083	,
2478836	,
2086221	,
2160432	,
1973525	,
2257112	,
2428106	,
1033348	,
1666660	,
2097915	,
1741214	,
1343385	,
1681696	,
2327155	,
2450160	,
1344627	,
2190871	,
2144604	,
1495792	,
2477881	,
1863699	,
1927220	,
1914659	,
2184991	,
1487352	,
1903672	,
1835391	,
2039568	,
2472450	,
2364970	,
2043932	,
2377942	,
1813408	,
2359906	,
2340626	,
2379464	,
2235524	,
2013468	,
1177990	,
2461786	,
1380016	,
1452652	,
412109	,
412486	,
2205206	,
2178730	,
1393721	,
1355778	,
1428449	,
1190462	,
2050539	,
1127163	,
2211371	,
2331663	,
2137924	,
2485869	,
2413246	,
2449161	,
2113276	,
2274361	,
411610	,
2207921	,
412391	,
2184522	,
2418668	,
1679384	,
2012938	,
2474513	,
2457568	,
1692798	,
2197072	,
1935426	,
2443662	,
2223005	,
2184535	,
1714606	,
1068616	,
2491338	,
2370088	,
2212880	,
1768399	,
1965346	,
201573	,
2185722	,
2098863	,
2463856	,
1565419	,
1737328	,
2274362	,
1297368	,
2223956	,
221287	,
1982737	,
2348914	,
2110097	,
1251633	,
1823313	,
1213591	,
2084227	,
1171840	,
1011220	,
2241815	,
2416669	,
1193708	,
2122361	,
1892748	,
1584738	,
2030988	,
2353138	,
1910042	,
2161543	,
2366101	,
2152963	,
1720030	,
2158526	,
1040700	,
2468263	,
1268501	,
2049981	,
1109887	,
2073833	,
1474993	,
2204549	,
1905954	,
1733397	,
2262649	,
1090440	,
2260324	,
1711726	,
2255571	,
2197249	,
1405675	,
1154267	,
1850544	,
2496604	,
2494099	,
2471980	,
2498919	,
2496603	,
2500885	,
2493781	,
2503882	,
2501432	,
2498799	,
2502802	,
1492716	,
2498603	,
2504377	,
2404679	,
2505928	,
2507580	,
2442732	,
2503812	,
2506765	,
2507502	,
2439546	,
2404031	,
2506382	,
2506975	,
2503613	,
2476568	,
2501820	,
2484920	,
2065980	,
1166110	)